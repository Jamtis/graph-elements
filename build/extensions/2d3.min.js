define(["exports","../../node_modules/d3/d3","../external/requestAnimationFunction","../external/mixin"],function(a,b,c,d){"use strict";var e=function(a){return a&&a.__esModule?a["default"]:a},f=function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){for(var c,d=[],e=a[Symbol.iterator]();!(c=e.next()).done&&(d.push(c.value),!b||d.length!==b););return d}throw new TypeError("Invalid attempt to destructure non-iterable instance")},g=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var i=e(b),j=c.requestAnimationFunction,k=e(d),l=Symbol(),m=Symbol(),n=Symbol(),o=Symbol(),p=Symbol(),q=Symbol(),r=Symbol();a.D3SVG=function(){function a(b,c,d){var e=this;if(h(this,a),!b)throw Error("No svg element specified");if(!c)throw Error("No graph specified");this[r]=d=k({circle:{radius:6},arrow:{width:5,ratio:2},force:{charge:-200,linkDistance:36,linkStrength:2.5,gravity:.15},size:{ratio:1,resizing:!0},drawing:!0},d,!1);var f=i.layout.force();f.charge(d.force.charge),f.linkDistance(d.force.linkDistance),f.linkStrength(d.force.linkStrength),f.gravity(d.force.gravity),this[q]=j(function(){var a=getComputedStyle(b),c=a.width,g=a.height;e[r].size.resizing&&(b.viewBox.baseVal.width=parseFloat(c)/d.size.ratio,b.viewBox.baseVal.height=parseFloat(g)/d.size.ratio),f.size([b.viewBox.baseVal.width,b.viewBox.baseVal.height]),f.alpha(.1)}),this[p]=c,this[l]=f,this[m]=i.select(b),this[l].on("tick",function(){e.drawing&&(e[n].attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),e[o].attr("d",function(a){var b=a.source,c=a.target,e=b.x-c.x,f=b.y-c.y,g=Math.hypot(e,f),h=e/g*d.arrow.width,i=f/g*d.arrow.width;isNaN(h)&&(h=0),isNaN(i)&&(i=0);var j=b.x-h*d.arrow.ratio,k=b.y-i*d.arrow.ratio;return"M"+c.x+","+c.y+"L "+j+","+k+"L "+(b.x+i)+","+(b.y-h)+"L "+(b.x-i)+","+(b.y+h)+"L "+j+","+k}))}),this.resize(),this.update()}return g(a,{update:{value:function(){var a=this,b=new Map(function(){var b=[],c=!0,d=!1,e=void 0;try{for(var g,h=a[p].nodes[Symbol.iterator]();!(c=(g=h.next()).done);c=!0){var i=f(g.value,1),j=i[0];b.push([j,{value:j}])}}catch(k){d=!0,e=k}finally{try{!c&&h["return"]&&h["return"]()}finally{if(d)throw e}}return b}()),c=function(){var a=[],c=!0,d=!1,e=void 0;try{for(var g,h=b[Symbol.iterator]();!(c=(g=h.next()).done);c=!0){var i=f(g.value,2),j=i[1];a.push(j)}}catch(k){d=!0,e=k}finally{try{!c&&h["return"]&&h["return"]()}finally{if(d)throw e}}return a}(),d=function(){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[p].edges[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var i=g.value,j=i.source,k=i.target;c.push({source:b.get(j),target:b.get(k)})}}catch(l){e=!0,f=l}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}();this[l].nodes(c).links(d).start(),this[o]=this[m].selectAll("path.edge").data(d),this[n]=this[m].selectAll("circle.node").data(c),this[o].enter().append("path").attr("class","edge"),this[n].enter().append("circle").attr("r",this[r].circle.radius).attr("class","node").call(this[l].drag),this[o].exit().remove(),this[n].exit().remove(),this[m].selectAll("circle.node,path.edge").sort(function(a){return("index"in a)-.5})}},resize:{value:function(){this[q]()}},graph:{get:function(){return this[p]}},force:{get:function(){return this[l]}},drawing:{get:function(){return this[r].drawing},set:function(a){this[r].drawing=!!a}},ratio:{get:function(){return this[r].size.ratio},set:function(){var a=void 0===arguments[0]?1:arguments[0];a=parseFloat(a),a>0&&1/0>a&&(this[r].size.ratio=a)}},resizing:{get:function(){return this[r].size.resizing},set:function(a){this[r].size.resizing=!!a}}}),a}()}});